---
import { getAbsoluteLocaleUrl } from 'astro:i18n';
import {
  createLanguagePattern,
  DEFAULT_LANGUAGE,
  languages,
} from '@/i18n/config';

// Get the current path without locale prefix
const langPattern = createLanguagePattern();
const currentPath = Astro.url.pathname
  .replace(langPattern, '')
  .replace(/^\//, '');

const hreflangLinks = Object.keys(languages).map((langCode) => {
  const href = getAbsoluteLocaleUrl(langCode, currentPath);
  return {
    lang: langCode,
    href,
  };
});

const defaultLangHref = getAbsoluteLocaleUrl(DEFAULT_LANGUAGE, currentPath);
---

{
  hreflangLinks.map(({ lang, href }) => (
    <link rel='alternate' hreflang={lang} href={href} />
  ))
}

<link rel='alternate' hreflang='x-default' href={defaultLangHref} />
